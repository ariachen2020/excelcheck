# Excel 格式比對工具

一個簡單易用的 Streamlit 應用，用於比對兩個 Excel 檔案的格式差異，以及驗證儲存格求和。

## 功能

### Tab 1: 格式比對
- ✓ 欄位名稱和順序檢查
- ✓ 資料類型檢查
- ✓ 數值格式（小數位數、長度）檢查
- ✓ 空值處理檢查
- ✓ 儲存格格式檢查
- ✓ 資料筆數檢查

### Tab 2: 求和驗證（新功能）
- ✓ 驗證儲存格範圍的求和
- ✓ 手動輸入儲存格位置（如 A1:A10）
- ✓ 檢查求和是否等於目標儲存格
- ✓ 顯示詳細的計算結果和誤差
- ✓ 支持 .xlsx 格式

## 安裝

### 方式 1：本地運行

1. **克隆或下載專案**
   ```bash
   cd excelcheck
   ```

2. **安裝依賴**
   ```bash
   pip install -r requirements.txt
   ```

3. **運行應用**
   ```bash
   streamlit run app.py
   ```

4. **訪問應用**
   - 應用會自動在瀏覽器中打開，通常是 `http://localhost:8501`

### 方式 2：部署到 Streamlit Cloud

1. **推送到 GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/yourusername/excelcheck.git
   git push -u origin main
   ```

2. **訪問 Streamlit Cloud**
   - 前往 https://streamlit.io/cloud
   - 使用 GitHub 帳號登錄
   - 點擊「New app」
   - 選擇此倉庫和 `app.py` 作為主文件

## 使用步驟

### 格式比對（Tab 1）

1. **上傳正確的 Excel 檔案**
   - 點擊左側「正確的檔案」上傳框
   - 選擇作為標準的 Excel 檔案

2. **上傳待檢查的 Excel 檔案**
   - 點擊右側「待檢查的檔案」上傳框
   - 選擇要驗證格式的 Excel 檔案

3. **開始比對**
   - 點擊「🔍 開始比對」按鈕
   - 等待檢查完成

4. **查看結果**
   - 查看頂部的統計摘要
   - 展開各個檢查項目查看詳細結果

### 求和驗證（Tab 2）- 新功能

1. **上傳 Excel 檔案**
   - 點擊「上傳 Excel 檔案」
   - 選擇 `.xlsx` 格式的檔案

2. **輸入儲存格範圍**
   - 例如：`A1:A10`（代表 A1 到 A10 的範圍）
   - 也支持單個儲存格：`A1` 或 `B5`

3. **輸入目標儲存格**
   - 例如：`B1`（要驗證的求和結果儲存格）

4. **驗證求和**
   - 點擊「✓ 驗證求和」按鈕
   - 等待驗證完成

5. **查看結果**
   - 查看驗證是否通過
   - 查看求和結果、目標值和誤差
   - 點擊「查看詳細數值」看範圍內的所有值

## 支持的檔案格式

- `.xls` (Excel 97-2003)
- `.xlsx` (Excel 2007+)

## 系統需求

- Python 3.8+
- pip（Python 包管理器）

## 依賴

- **streamlit** - Web 應用框架
- **pandas** - 資料處理
- **xlrd** - Excel 讀取
- **openpyxl** - Excel 處理

## 常見問題

### 格式比對相關

**Q: 為什麼無法讀取某些 Excel 檔案？**
A: 確保檔案不是損壞的，且不被其他程式鎖定。如果是較新的 Excel 格式，請嘗試另存為 `.xlsx`。

**Q: 如何在本地私密部署？**
A: 可以在自己的伺服器上運行 `streamlit run app.py`，或使用 Streamlit Community Cloud 進行部署。

**Q: 支持多個工作表嗎？**
A: 目前只支持 Excel 檔案的第一個工作表。

### 求和驗證相關

**Q: 為什麼求和驗證只支持 .xlsx？**
A: `.xls` 格式较舊，不容易精確定位儲存格。建議將檔案另存為 `.xlsx` 格式。

**Q: 儲存格範圍如何輸入？**
A: 支持以下格式：
   - 單個儲存格：`A1`, `B5`
   - 範圍：`A1:A10`, `B2:B20`, `A1:C10` (跨列範圍)
   - 都使用大寫字母，例如 `a1:a10` 會自動轉換為 `A1:A10`

**Q: 如何驗證多列的求和？**
A: 可以使用跨列範圍，例如 `A1:C10` 會驗證 A、B、C 三列的所有儲存格 (1-10 行)。

**Q: 為什麼顯示「誤差」而不是完全不相等？**
A: 這是正常的，由於浮點數的精度限制，會允許極小的誤差（< 1e-9）。

## 許可證

MIT License

## 聯絡方式

如有問題或建議，請提出 Issue 或 PR。
